<!DOCTYPE html>
<html>
<head>
  <!-- Import Vega 3 & Vega-Lite 2 (does not have to be from CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/vega@3.0.10"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@2.1.2"></script>
  <!-- Import vega-embed -->
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@3.0.0"></script>
</head>
<body>

<div id="vis"></div>

<script type="text/javascript">
  var spec = 
{
"$schema": "https://vega.github.io/schema/vega/v3.0.json",
"description": "An overview of future clothing sizes for a newborn",
"autosize": "pad",
"padding": {"left":5, "right":30, "bottom": 60, "top": 0},
"width": 800,
"style": "cell",
"data": [
{
"name": "length_by_age_raw",
"format": {"type": "json"},
"values": [
{"Sex":1,"Agemos":0.0,"L":1.267004226,"M":49.98888408,"S":0.053112191, "name": "Kleidergröße"},
{"Sex":1,"Agemos":0.5,"L":0.511237696,"M":52.6959753,"S":0.048692684, "name": "Kleidergröße"},
{"Sex":1,"Agemos":1.5,"L":-0.45224446,"M":56.62842855,"S":0.04411683, "name": "Kleidergröße"},
{"Sex":1,"Agemos":2.5,"L":-0.990594599,"M":59.60895343,"S":0.041795583, "name": "Kleidergröße"},
{"Sex":1,"Agemos":3.5,"L":-1.285837689,"M":62.07700027,"S":0.040454126, "name": "Kleidergröße"},
{"Sex":1,"Agemos":4.5,"L":-1.43031238,"M":64.2168641,"S":0.039633879, "name": "Kleidergröße"},
{"Sex":1,"Agemos":5.5,"L":-1.47657547,"M":66.1253149,"S":0.039123813, "name": "Kleidergröße"},
{"Sex":1,"Agemos":6.5,"L":-1.456837849,"M":67.8601799,"S":0.038811994, "name": "Kleidergröße"},
{"Sex":1,"Agemos":7.5,"L":-1.391898768,"M":69.45908458,"S":0.038633209, "name": "Kleidergröße"},
{"Sex":1,"Agemos":8.5,"L":-1.29571459,"M":70.94803912,"S":0.038546833, "name": "Kleidergröße"},
{"Sex":1,"Agemos":9.5,"L":-1.177919048,"M":72.34586111,"S":0.038526262, "name": "Kleidergröße"},
{"Sex":1,"Agemos":10.5,"L":-1.045326049,"M":73.6666541,"S":0.038553387, "name": "Kleidergröße"},
{"Sex":1,"Agemos":11.5,"L":-0.902800887,"M":74.92129717,"S":0.038615501, "name": "Kleidergröße"},
{"Sex":1,"Agemos":12.5,"L":-0.753908107,"M":76.11837536,"S":0.038703461, "name": "Kleidergröße"},
{"Sex":1,"Agemos":13.5,"L":-0.601263523,"M":77.26479911,"S":0.038810557, "name": "Kleidergröße"},
{"Sex":1,"Agemos":14.5,"L":-0.446805039,"M":78.36622309,"S":0.038931784, "name": "Kleidergröße"},
{"Sex":1,"Agemos":15.5,"L":-0.291974772,"M":79.4273405,"S":0.039063356, "name": "Kleidergröße"},
{"Sex":1,"Agemos":16.5,"L":-0.13784767,"M":80.45209492,"S":0.039202382, "name": "Kleidergröße"},
{"Sex":1,"Agemos":17.5,"L":0.014776155,"M":81.44383603,"S":0.039346629, "name": "Kleidergröße"},
{"Sex":1,"Agemos":18.5,"L":0.165304169,"M":82.40543643,"S":0.039494365, "name": "Kleidergröße"},
{"Sex":1,"Agemos":19.5,"L":0.313301809,"M":83.33938063,"S":0.039644238, "name": "Kleidergröße"},
{"Sex":1,"Agemos":20.5,"L":0.458455471,"M":84.24783394,"S":0.039795189, "name": "Kleidergröße"},
{"Sex":1,"Agemos":21.5,"L":0.600544631,"M":85.13269658,"S":0.039946388, "name": "Kleidergröße"},
{"Sex":1,"Agemos":22.5,"L":0.739438953,"M":85.9956488,"S":0.040097181, "name": "Kleidergröße"},
{"Sex":1,"Agemos":23.5,"L":0.875000447,"M":86.8381751,"S":0.04024706, "name": "Kleidergröße"},
{"Sex":1,"Agemos":24.5,"L":1.00720807,"M":87.66160934,"S":0.040395626, "name": "Kleidergröße"},
{"Sex":1,"Agemos":25.5,"L":0.837251351,"M":88.45247282,"S":0.040577525, "name": "Kleidergröße"},
{"Sex":1,"Agemos":26.5,"L":0.681492975,"M":89.22326434,"S":0.040723122, "name": "Kleidergröße"},
{"Sex":1,"Agemos":27.5,"L":0.538779654,"M":89.97549228,"S":0.040833194, "name": "Kleidergröße"},
{"Sex":1,"Agemos":28.5,"L":0.407697153,"M":90.71040853,"S":0.040909059, "name": "Kleidergröße"},
{"Sex":1,"Agemos":29.5,"L":0.286762453,"M":91.42907762,"S":0.040952433, "name": "Kleidergröße"},
{"Sex":1,"Agemos":30.5,"L":0.174489485,"M":92.13242379,"S":0.04096533, "name": "Kleidergröße"},
{"Sex":1,"Agemos":31.5,"L":0.069444521,"M":92.82127167,"S":0.040949976, "name": "Kleidergröße"},
{"Sex":1,"Agemos":32.5,"L":-0.029720564,"M":93.49637946,"S":0.040908737, "name": "Kleidergröße"},
{"Sex":1,"Agemos":33.5,"L":-0.124251789,"M":94.15846546,"S":0.040844062, "name": "Kleidergröße"},
{"Sex":1,"Agemos":34.5,"L":-0.215288396,"M":94.80822923,"S":0.040758431, "name": "Kleidergröße"},
{"Sex":1,"Agemos":35.5,"L":-0.30385434,"M":95.44636981,"S":0.040654312, "name": "Kleidergröße"},
{"Sex":2,"Agemos":0.0,"L":-1.295960857,"M":49.28639612,"S":0.05008556, "name": "Kleidergröße"},
{"Sex":2,"Agemos":0.5,"L":-0.809249882,"M":51.68358057,"S":0.046818545, "name": "Kleidergröße"},
{"Sex":2,"Agemos":1.5,"L":-0.050782985,"M":55.28612813,"S":0.0434439, "name": "Kleidergröße"},
{"Sex":2,"Agemos":2.5,"L":0.476851407,"M":58.09381906,"S":0.041716103, "name": "Kleidergröße"},
{"Sex":2,"Agemos":3.5,"L":0.843299612,"M":60.45980763,"S":0.040705173, "name": "Kleidergröße"},
{"Sex":2,"Agemos":4.5,"L":1.097562257,"M":62.53669656,"S":0.040079765, "name": "Kleidergröße"},
{"Sex":2,"Agemos":5.5,"L":1.272509641,"M":64.40632762,"S":0.039686845, "name": "Kleidergröße"},
{"Sex":2,"Agemos":6.5,"L":1.390428859,"M":66.11841553,"S":0.039444555, "name": "Kleidergröße"},
{"Sex":2,"Agemos":7.5,"L":1.466733925,"M":67.70574419,"S":0.039304738, "name": "Kleidergröße"},
{"Sex":2,"Agemos":8.5,"L":1.512301976,"M":69.19123614,"S":0.03923711, "name": "Kleidergröße"},
{"Sex":2,"Agemos":9.5,"L":1.534950767,"M":70.59163924,"S":0.039221665, "name": "Kleidergröße"},
{"Sex":2,"Agemos":10.5,"L":1.540390875,"M":71.91961673,"S":0.039244672, "name": "Kleidergröße"},
{"Sex":2,"Agemos":11.5,"L":1.532852892,"M":73.1850104,"S":0.03929642, "name": "Kleidergröße"},
{"Sex":2,"Agemos":12.5,"L":1.51550947,"M":74.39564379,"S":0.039369875, "name": "Kleidergröße"},
{"Sex":2,"Agemos":13.5,"L":1.490765028,"M":75.5578544,"S":0.039459832, "name": "Kleidergröße"},
{"Sex":2,"Agemos":14.5,"L":1.460458255,"M":76.67685871,"S":0.039562382, "name": "Kleidergröße"},
{"Sex":2,"Agemos":15.5,"L":1.426006009,"M":77.75700986,"S":0.039674542, "name": "Kleidergröße"},
{"Sex":2,"Agemos":16.5,"L":1.388507095,"M":78.80198406,"S":0.03979401, "name": "Kleidergröße"},
{"Sex":2,"Agemos":17.5,"L":1.348818127,"M":79.81491852,"S":0.039918994, "name": "Kleidergröße"},
{"Sex":2,"Agemos":18.5,"L":1.307609654,"M":80.79851532,"S":0.040048084, "name": "Kleidergröße"},
{"Sex":2,"Agemos":19.5,"L":1.265408149,"M":81.75512092,"S":0.040180162, "name": "Kleidergröße"},
{"Sex":2,"Agemos":20.5,"L":1.222627732,"M":82.6867881,"S":0.04031434, "name": "Kleidergröße"},
{"Sex":2,"Agemos":21.5,"L":1.179594365,"M":83.59532461,"S":0.040449904, "name": "Kleidergröße"},
{"Sex":2,"Agemos":22.5,"L":1.136564448,"M":84.48233206,"S":0.040586283, "name": "Kleidergröße"},
{"Sex":2,"Agemos":23.5,"L":1.093731947,"M":85.34923624,"S":0.040723015, "name": "Kleidergröße"},
{"Sex":2,"Agemos":24.5,"L":1.051272912,"M":86.1973169,"S":0.040859727, "name": "Kleidergröße"},
{"Sex":2,"Agemos":25.5,"L":1.041951175,"M":87.09026318,"S":0.041142161, "name": "Kleidergröße"},
{"Sex":2,"Agemos":26.5,"L":1.012592236,"M":87.95714182,"S":0.041349399, "name": "Kleidergröße"},
{"Sex":2,"Agemos":27.5,"L":0.970541909,"M":88.7960184,"S":0.041500428, "name": "Kleidergröße"},
{"Sex":2,"Agemos":28.5,"L":0.921129988,"M":89.6055115,"S":0.041610508, "name": "Kleidergröße"},
{"Sex":2,"Agemos":29.5,"L":0.868221392,"M":90.38476689,"S":0.041691761, "name": "Kleidergröße"},
{"Sex":2,"Agemos":30.5,"L":0.81454413,"M":91.13341722,"S":0.04175368, "name": "Kleidergröße"},
{"Sex":2,"Agemos":31.5,"L":0.761957977,"M":91.8515436,"S":0.041803562, "name": "Kleidergröße"},
{"Sex":2,"Agemos":32.5,"L":0.711660228,"M":92.5396352,"S":0.041846882, "name": "Kleidergröße"},
{"Sex":2,"Agemos":33.5,"L":0.664323379,"M":93.19854429,"S":0.041887626, "name": "Kleidergröße"},
{"Sex":2,"Agemos":34.5,"L":0.620285102,"M":93.82945392,"S":0.041928568, "name": "Kleidergröße"},
{"Sex":2,"Agemos":35.5,"L":0.57955631,"M":94.43382278,"S":0.041971514, "name": "Kleidergröße"}
]
},
{
"name": "length_by_age",
"source": "length_by_age_raw",
"transform": [
{
"type": "filter",
"expr": "datum.Agemos > 0"
},
{
"type": "filter",
"expr": "datum.Sex == sex_numeric"
},
{
"type": "formula",
"expr": "datum.Sex",
"as": "sex"
},
{
"type": "formula",
"expr": "datum.Agemos",
"as": "age_months"
},
{
"type": "formula",
"expr": "datetime(birthday_year, birthday_month, birthday_day+30*(ceil(datum.Agemos)-1))",
"as": "month_of_life_first_day"
},
{
"type": "formula",
"expr": "datetime(birthday_year, birthday_month, birthday_day+30*ceil(datum.Agemos)-1)",
"as": "month_of_life_last_day"
},
{
"type": "formula",
"expr": "ceil((-2 + datum.M*(pow(1 + datum.L*datum.S*z_score, 1/datum.L)))/6.0)*6 + 2",
"as": "size"
}
]
},
{
"name": "time_by_size",
"source": "length_by_age",
"transform": [
{
"type": "aggregate",
"groupby": ["size"],
"fields": ["month_of_life_first_day", "month_of_life_last_day", "name"],
"ops": ["min", "max", "min"],
"as": ["from", "to", "name"]
}
]
}
],
"signals": [
{
"name": "y_step",
"value": 50
},
{
"name": "height",
"update": "bandspace(domain('y').length, 0.1, 0.05) * y_step"
},
{
"name": "Geburtsdatum",
"bind": {"input": "date"}
},
{
"name": "Geburtsgröße",
"value": "50",
"bind": {"input": "range", "min": 45, "max": 60, "step": 0.5}
},
{
"name": "Geschlecht",
"value": "Junge",
"bind": {"input": "radio", "options": ["Junge", "Mädchen"]}
},
{
"name": "sex_numeric",
"update": "if(Geschlecht=='Junge', 1, 2)"
},
{
"name": "z_score",
"update": "if(Geschlecht=='Junge', (pow(Geburtsgröße, 1.267004226)/pow(49.98888408, 1.267004226)-1)/1.267004226/0.053112191, (pow(Geburtsgröße, -1.295960857)/pow(49.28639612, -1.295960857)-1)/-1.295960857/0.05008556)"
},
{
"name": "birthday_day",
"update": "date(Geburtsdatum)"
},
{
"name": "birthday_month",
"update": "month(Geburtsdatum)"
},
{
"name": "birthday_year",
"update": "year(Geburtsdatum)"
}
],
"marks": [
{
"name": "boxes",
"type": "rect",
"style": [
"bar"
],
"from": {
"data": "time_by_size"
},
"encode": {
"update": {
"fill": {
"value": "#4c78a8"
},
"x": {
"scale": "x",
"field": "from"
},
"x2": {
"scale": "x",
"field": "to"
},
"y": {
"scale": "y",
"field": "name"
},
"height": {
"scale": "y",
"band": true
}
}
}
},
{
"type": "text",
"from": {"data": "time_by_size"},
"interactive": false,
"encode": {
"update": {
"font": {"value": "Verdana"},
"fontSize": {"value": 16},
"fontStyle": {"value": "normal"},
"x": {"scale": "x", "field": "from", "offset": 12},
"y": {"scale": "y", "field": "name", "offset": 22},
"stroke": {"value": "white"},
"align": {"value": "center"},
"baseline": {"value": "middle"},
"text": {"field": "size"}
}
}
}
],
"scales": [
{
"name": "x",
"type": "time",
"range": "width",
"domain": {"data": "time_by_size", "fields": ["from", "to"]}
},
{
"name": "y",
"type": "band",
"domain": {
"data": "time_by_size",
"field": "name",
"sort": true
},
"range": {
"step": {
"signal": "y_step"
}
},
"paddingInner": 0.1,
"paddingOuter": 0.05
}
],
"axes": [
{
"scale": "x",
"format": "%d-%b-%Y",
"orient": "bottom",
"title": "",
"labelFlush": true,
"labelOverlap": false,
"tickCount": {"interval": "month", "step": 2},
"zindex": 1,
"encode": {
"labels": {
"update": {
"angle": {"value": 30},
"fontSize": {"value": 12},
"align": {"value": "left"},
"baseline": {"value": "middle"},
"dy": {"value": 3}
}
}
}
},
{
"scale": "x",
"orient": "bottom",
"grid": true,
"domain": false,
"labels": false,
"tickCount": {"interval": "month", "step": 1},
"maxExtent": 0,
"minExtent": 0,
"ticks": true,
"zindex": 0
},
{
"scale": "y",
"orient": "left",
"title": "",
"labelOverlap": true,
"zindex": 1,
"ticks": false,
"encode": {
"labels": {
"update": {
"fontSize": {"value": 14}
}
}
}
}
],
"config": {
"axisY": {
"minExtent": 30
}
}
}
  vegaEmbed('#vis', spec, opt={"actions": false});
</script>
</body>
</html>